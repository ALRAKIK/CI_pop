module u_funcs
    implicit none
    private
    public :: u0, u1, u2, u3, u4, u5, u6, u7, u8, u9, u10, u11, u12, u13
    
    ! Mark all as pure and inline-friendly
contains
    
    pure function u0(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 1.0d0
    end function u0
    
    pure function u1(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        ! (3*t - 5*t^3)/24 = t*(3 - 5*t^2)/24
        t2 = t(2)  ! t^2 is pre-computed
        res = t(1) * (3.0d0 - 5.0d0*t2) / 24.0d0
    end function u1
    
    pure function u2(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        ! (81*t^2 - 462*t^4 + 385*t^6)/1152 = t^2*(81 + t^2*(-462 + 385*t^2))/1152
        t2 = t(2)
        res = t2 * (81.0d0 + t2*(-462.0d0 + 385.0d0*t2)) / 1152.0d0
    end function u2
    
    pure function u3(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        ! t^3 * (30375 + t^2*(-369603 + t^2*(765765 - 425425*t^2)))
        t2 = t(2)
        res = t(3) * (30375.0d0 + t2*(-369603.0d0 + t2*(765765.0d0 - 425425.0d0*t2))) &
              / 414720.0d0
    end function u3
    
    pure function u4(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        ! t^4 * (4465125 + t^2*(-94121676 + t^2*(349922430 + t^2*(-446185740 + 185910725*t^2))))
        t2 = t(2)
        res = t(4) * (4465125.0d0 + t2*(-94121676.0d0 + t2*(349922430.0d0 + &
              t2*(-446185740.0d0 + 185910725.0d0*t2)))) / 39813120.0d0
    end function u4
    
    pure function u5(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(5) * (0.2271080017089844d0 + t2*(-7.368794359479632d0 + &
              t2*(42.53499874538845d0 + t2*(-91.81824154324002d0 + &
              t2*(84.63621767460073d0 - 28.21207255820024d0*t2)))))
    end function u5
    
    pure function u6(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(6) * (0.5725014209747314d0 + t2*(-26.49143048695156d0 + &
              t2*(218.1905117442116d0 + t2*(-699.5796273761325d0 + &
              t2*(1059.990452528000d0 + t2*(-765.2524681411816d0 + &
              212.5701300392171d0*t2))))))
    end function u6
    
    pure function u7(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(7) * (1.727727502584457d0 + t2*(-108.0909197883947d0 + &
              t2*(1200.902913216352d0 + t2*(-5305.646978613403d0 + &
              t2*(11655.39333686453d0 + t2*(-13586.55000643414d0 + &
              t2*(8061.722181737309d0 - 1919.457662318407d0*t2)))))))
    end function u7
    
    pure function u8(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(8) * (6.074042001273483d0 + t2*(-493.9153047730880d0 + &
              t2*(7109.514302489364d0 + t2*(-41192.65496889755d0 + &
              t2*(122200.4649830175d0 + t2*(-203400.1772804155d0 + &
              t2*(192547.0012325315d0 + t2*(-96980.59838863751d0 + &
              20204.29133096615d0*t2))))))))
    end function u8
    
    pure function u9(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(9) * (24.38052969955606d0 + t2*(-2499.830481811210d0 + &
              t2*(45218.76898136273d0 + t2*(-331645.1724845636d0 + &
              t2*(1.268365273321625d6 + t2*(-2.813563226586534d6 + &
              t2*(3.763271297656404d6 + t2*(-2.998015918538107d6 + &
              t2*(1.311763614662977d6 - 242919.1879005513d0*t2)))))))))
    end function u9
    
    pure function u10(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(10) * (110.0171402692467d0 + t2*(-13886.08975371704d0 + &
              t2*(308186.4046126624d0 + t2*(-2.785618128086455d6 + &
              t2*(1.328876716642182d7 + t2*(-3.756717666076335d7 + &
              t2*(6.634451227472903d7 + t2*(-7.410514821153266d7 + &
              t2*(5.095260249266464d7 + t2*(-1.970681911843223d7 + &
              3.284469853072038d6*t2))))))))))
    end function u10
    
    pure function u11(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(11) * (551.3358961220206d0 + t2*(-84005.43360302409d0 + &
              t2*(2.243768177922449d6 + t2*(-2.447406272573873d7 + &
              t2*(1.420629077975331d8 + t2*(-4.958897842750303d8 + &
              t2*(1.106842816823014d9 + t2*(-1.621080552108337d9 + &
              t2*(1.553596899570580d9 + t2*(-9.394623596815784d8 + &
              t2*(3.255730741857657d8 - 4.932925366450996d7*t2)))))))))))
    end function u11
    
    pure function u12(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(12) * (3038.090510922384d0 + t2*(-549842.3275722887d0 + &
              t2*(1.739510755397816d7 + t2*(-2.251056618894153d8 + &
              t2*(1.559279864879258d9 + t2*(-6.563293792619284d9 + &
              t2*(1.795421373115560d10 + t2*(-3.302659974980072d10 + &
              t2*(4.128018557975397d10 + t2*(-3.463204338815878d10 + &
              t2*(1.868820750929582d10 + t2*(-5.866481492051847d9 + &
              8.147890961183121d8*t2))))))))))))
    end function u12
    
    pure function u13(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        real(8) :: t2
        t2 = t(2)
        res = t(13) * (18257.75547429317d0 + t2*(-3.871833442572613d6 + &
              t2*(1.431578767188890d8 + t2*(-2.167164983223795d9 + &
              t2*(1.763473060683497d10 + t2*(-8.786707217802327d10 + &
              t2*(2.879006499061506d11 + t2*(-6.453648692453765d11 + &
              t2*(1.008158106865382d12 + t2*(-1.098375156081223d12 + &
              t2*(8.192186695485773d11 + t2*(-3.990961752244665d11 + &
              t2*(1.144982377320258d11 - 1.467926124769562d10*t2)))))))))))))
    end function u13
    
end module u_funcs