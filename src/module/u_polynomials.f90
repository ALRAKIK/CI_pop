!------------------------------------------------------------------------------
! This file is part of CUSF - Fortran port
! 
! CUSF - Math library for Special Functions
! Fortran translation of u_polynomials.tpp
!
! CUSF is free software; you can redistribute it and/or modify it under the 
! terms of the standard MIT license.
!------------------------------------------------------------------------------

module u_funcs
    implicit none
    private
    
    ! Make functions public
    public :: u0, u1, u2, u3, u4, u5, u6, u7, u8, u9, u10, u11, u12, u13
    
contains

    !---------------------------------------------------------------------------
    ! Un(t) polynomial functions
    ! Input: t(0:3*n) - array containing powers of t: t(0)=1, t(1)=t, t(2)=t^2, etc.
    ! Output: Un(t) polynomial evaluation
    !---------------------------------------------------------------------------
    
    function u0(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 1.0d0
    end function u0
    
    function u1(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = (3.0d0*t(1) - 5.0d0*t(3)) / 24.0d0
    end function u1
    
    function u2(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = (81.0d0*t(2) - 462.0d0*t(4) + 385.0d0*t(6)) / 1152.0d0
    end function u2
    
    function u3(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = (30375.0d0*t(3) - 369603.0d0*t(5) + 765765.0d0*t(7) - &
               425425.0d0*t(9)) / 414720.0d0
    end function u3
    
    function u4(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = (4465125.0d0*t(4) - 94121676.0d0*t(6) + 349922430.0d0*t(8) - &
               446185740.0d0*t(10) + 185910725.0d0*t(12)) / 39813120.0d0
    end function u4
    
    function u5(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 0.2271080017089844d0 * t(5) - 7.368794359479632d0 * t(7) + &
              42.53499874538845d0 * t(9) - 91.81824154324002d0 * t(11) + &
              84.63621767460073d0 * t(13) - 28.21207255820024d0 * t(15)
    end function u5
    
    function u6(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 0.5725014209747314d0 * t(6) - 26.49143048695156d0 * t(8) + &
              218.1905117442116d0 * t(10) - 699.5796273761325d0 * t(12) + &
              1059.990452528000d0 * t(14) - 765.2524681411816d0 * t(16) + &
              212.5701300392171d0 * t(18)
    end function u6
    
    function u7(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 1.727727502584457d0 * t(7) - 108.0909197883947d0 * t(9) + &
              1200.902913216352d0 * t(11) - 5305.646978613403d0 * t(13) + &
              11655.39333686453d0 * t(15) - 13586.55000643414d0 * t(17) + &
              8061.722181737309d0 * t(19) - 1919.457662318407d0 * t(21)
    end function u7
    
    function u8(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 6.074042001273483d0 * t(8) - 493.9153047730880d0 * t(10) + &
              7109.514302489364d0 * t(12) - 41192.65496889755d0 * t(14) + &
              122200.4649830175d0 * t(16) - 203400.1772804155d0 * t(18) + &
              192547.0012325315d0 * t(20) - 96980.59838863751d0 * t(22) + &
              20204.29133096615d0 * t(24)
    end function u8
    
    function u9(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 24.38052969955606d0 * t(9) - 2499.830481811210d0 * t(11) + &
              45218.76898136273d0 * t(13) - 331645.1724845636d0 * t(15) + &
              1.268365273321625d6 * t(17) - 2.813563226586534d6 * t(19) + &
              3.763271297656404d6 * t(21) - 2.998015918538107d6 * t(23) + &
              1.311763614662977d6 * t(25) - 242919.1879005513d0 * t(27)
    end function u9
    
    function u10(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 110.0171402692467d0 * t(10) - 13886.08975371704d0 * t(12) + &
              308186.4046126624d0 * t(14) - 2.785618128086455d6 * t(16) + &
              1.328876716642182d7 * t(18) - 3.756717666076335d7 * t(20) + &
              6.634451227472903d7 * t(22) - 7.410514821153266d7 * t(24) + &
              5.095260249266464d7 * t(26) - 1.970681911843223d7 * t(28) + &
              3.284469853072038d6 * t(30)
    end function u10
    
    function u11(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 551.3358961220206d0 * t(11) - 84005.43360302409d0 * t(13) + &
              2.243768177922449d6 * t(15) - 2.447406272573873d7 * t(17) + &
              1.420629077975331d8 * t(19) - 4.958897842750303d8 * t(21) + &
              1.106842816823014d9 * t(23) - 1.621080552108337d9 * t(25) + &
              1.553596899570580d9 * t(27) - 9.394623596815784d8 * t(29) + &
              3.255730741857657d8 * t(31) - 4.932925366450996d7 * t(33)
    end function u11
    
    function u12(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 3038.090510922384d0 * t(12) - 549842.3275722887d0 * t(14) + &
              1.739510755397816d7 * t(16) - 2.251056618894153d8 * t(18) + &
              1.559279864879258d9 * t(20) - 6.563293792619284d9 * t(22) + &
              1.795421373115560d10 * t(24) - 3.302659974980072d10 * t(26) + &
              4.128018557975397d10 * t(28) - 3.463204338815878d10 * t(30) + &
              1.868820750929582d10 * t(32) - 5.866481492051847d9 * t(34) + &
              8.147890961183121d8 * t(36)
    end function u12
    
    function u13(t) result(res)
        real(8), intent(in) :: t(0:)
        real(8) :: res
        res = 18257.75547429317d0 * t(13)  - 3.871833442572613d6  * t(15) + &
              1.431578767188890d8 * t(17)  - 2.167164983223795d9  * t(19) + &
              1.763473060683497d10 * t(21) - 8.786707217802327d10 * t(23) + &
              2.879006499061506d11 * t(25) - 6.453648692453765d11 * t(27) + &
              1.008158106865382d12 * t(29) - 1.098375156081223d12 * t(31) + &
              8.192186695485773d11 * t(33) - 3.990961752244665d11 * t(35) + &
              1.144982377320258d11 * t(37) - 1.467926124769562d10 * t(39)
    end function u13

end module u_funcs
